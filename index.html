<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QRTurbo Code Generator</title>
    <!-- Favicons -->
    <link rel="icon" type="image/png" sizes="192x192" href="/android-chrome-192x192.png">
    <link rel="icon" type="image/png" sizes="512x512" href="/android-chrome-512x512.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="manifest" href="/manifest.json">
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 600px;
            margin: 0 auto;
            padding: 20px;
            text-align: center;
            background-color: #f0f0f0;
            animation: fadeIn 0.8s ease-in-out;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        h1 {
            animation: slideInDown 1s ease-out;
            color: #333;
            margin-bottom: 30px;
        }

        @keyframes slideInDown {
            from {
                opacity: 0;
                transform: translateY(-30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        #qr-container {
            margin-top: 20px;
            background-color: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            animation: slideInUp 0.8s ease-out 0.3s both;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        #qr-container:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }

        @keyframes slideInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        input, button, #size-select {
            font-size: 14px;
            margin: 10px 0;
            padding: 12px;
            width: 100%;
            box-sizing: border-box;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            transition: all 0.3s ease;
            animation: fadeInUp 0.6s ease-out 0.5s both;
        }

        input:focus, #size-select:focus {
            outline: none;
            border-color: #007acc;
            box-shadow: 0 0 0 3px rgba(0, 122, 204, 0.1);
            transform: scale(1.02);
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        button {
            background: linear-gradient(135deg, #007acc, #005a9e);
            color: white;
            border: none;
            cursor: pointer;
            font-weight: bold;
            position: relative;
            overflow: hidden;
        }

        button:hover {
            background: linear-gradient(135deg, #005a9e, #004080);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 122, 204, 0.3);
        }

        button:active {
            transform: translateY(0);
            box-shadow: 0 2px 8px rgba(0, 122, 204, 0.3);
        }

        button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s;
        }

        button:hover::before {
            left: 100%;
        }

        #qr-image {
            max-width: 100%;
            height: auto;
            margin-top: 20px;
            border-radius: 8px;
            transition: all 0.3s ease;
            animation: qrAppear 0.6s ease-out;
        }

        @keyframes qrAppear {
            from {
                opacity: 0;
                transform: scale(0.8) rotate(5deg);
            }
            to {
                opacity: 1;
                transform: scale(1) rotate(0deg);
            }
        }

        #qr-image:hover {
            transform: scale(1.05);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }

        #download-btn {
            display: none;
            margin-top: 15px;
            background: linear-gradient(135deg, #28a745, #20c997);
            animation: bounceIn 0.6s ease-out;
        }

        #download-btn:hover {
            background: linear-gradient(135deg, #20c997, #17a2b8);
        }

        @keyframes bounceIn {
            0% {
                opacity: 0;
                transform: scale(0.3);
            }
            50% {
                opacity: 1;
                transform: scale(1.05);
            }
            70% {
                transform: scale(0.9);
            }
            100% {
                opacity: 1;
                transform: scale(1);
            }
        }

        #char-count {
            color: #666;
            font-size: 0.8em;
            margin-bottom: 10px;
            animation: fadeIn 0.8s ease-out 0.7s both;
            transition: color 0.3s ease;
        }

        #char-count.warning {
            color: #ff6b35;
            animation: pulse 1s ease-in-out;
        }

        @keyframes pulse {
            0%, 100% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.05);
            }
        }

        #size-select {
            background-color: white;
            cursor: pointer;
        }

        #size-select:hover {
            border-color: #007acc;
        }

        p {
            animation: fadeIn 1s ease-out 1s both;
        }

        a {
            transition: all 0.3s ease;
            text-decoration: none;
        }

        a:hover {
            color: #005a9e !important;
            text-decoration: underline;
        }

        /* Loading animation for QR generation */
        .loading {
            position: relative;
        }

        .loading::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 20px;
            height: 20px;
            margin: -10px 0 0 -10px;
            border: 2px solid #f3f3f3;
            border-top: 2px solid #007acc;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Responsive animations */
        @media (max-width: 768px) {
            body {
                padding: 15px;
            }
            
            #qr-container {
                padding: 15px;
            }
            
            button:hover {
                transform: none;
            }
        }

        #qr-code-text {
            font-size: 0.9em;
            color: #555;
            margin-top: 15px;
            word-wrap: break-word;
            padding: 10px;
            background-color: #f9f9f9;
            border-radius: 5px;
            border: 1px solid #eee;
            animation: fadeIn 0.5s ease-out;
        }

        #qr-placeholder {
            color: #888;
            margin-top: 20px;
            padding: 20px 0;
        }

        /* Tab Styles */
        #tabs {
            display: flex;
            margin-bottom: 20px;
            gap: 10px;
            animation: fadeIn 0.8s ease-in-out;
        }

        .tab-link {
            background: #fff;
            color: #333;
            border: 2px solid #e0e0e0;
            outline: none;
            cursor: pointer;
            padding: 12px 16px;
            font-size: 16px;
            transition: all 0.3s ease;
            margin: 0;
            width: auto;
            box-sizing: border-box;
            border-radius: 8px;
            font-weight: bold;
            position: relative;
        }
        
        .tab-link:hover:not(.active) {
            border-color: #aaa;
            transform: translateY(-2px);
            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
        }
        
        .tab-link.active {
            background: linear-gradient(135deg, #28a745, #20c997);
            color: white;
            border-color: transparent;
            box-shadow: 0 4px 10px rgba(40, 167, 69, 0.3);
        }

        .tab-link.active:hover {
             background: linear-gradient(135deg, #20c997, #17a2b8);
             transform: translateY(-2px);
             box-shadow: 0 6px 15px rgba(32, 201, 151, 0.4);
        }

        .tab-content {
            display: none;
            animation: fadeIn 0.5s;
        }

        .vcard-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }

        .vcard-grid .full-width {
            grid-column: 1 / -1;
        }

        #vcard-grid input {
             margin: 5px 0;
        }
    </style>
</head>
<body>
    <h1>QRTurbo Code Generator</h1>

    <div id="tabs">
        <button class="tab-link active" onclick="openTab(event, 'URLText')">URL/Text</button>
        <button class="tab-link" onclick="openTab(event, 'VCard')">vCard</button>
    </div>

    <div id="URLText" class="tab-content" style="display: block;">
        <input type="text" id="qr-text" placeholder="Enter text or URL" maxlength="300">
        <div id="char-count">0 / 300 characters</div>
    </div>

    <div id="VCard" class="tab-content">
        <div class="vcard-grid">
            <input type="text" id="vcard-fn" placeholder="First Name">
            <input type="text" id="vcard-ln" placeholder="Last Name">
            <input type="text" id="vcard-org" placeholder="Organization">
            <input type="text" id="vcard-title" placeholder="Title">
            <input type="tel" id="vcard-tel-work" placeholder="Phone (Work)">
            <input type="tel" id="vcard-tel-mobile" placeholder="Phone (Mobile)">
            <input type="email" id="vcard-email" placeholder="Email" class="full-width">
            <input type="url" id="vcard-url" placeholder="Website" class="full-width">
            <input type="text" id="vcard-street" placeholder="Street" class="full-width">
            <input type="text" id="vcard-city" placeholder="City">
            <input type="text" id="vcard-state" placeholder="State/Province">
            <input type="text" id="vcard-zip" placeholder="ZIP/Postal Code">
            <input type="text" id="vcard-country" placeholder="Country">
        </div>
    </div>
    
    <select id="size-select">
        <option value="5">Small (5)</option>
        <option value="10" selected>Medium (10)</option>
        <option value="15">Large (15)</option>
    </select>
    
    <button onclick="generateQRCode()">Create QR Code</button>
    
    <div id="qr-container">
        <p id="qr-placeholder">QR Code will appear here</p>
        <img id="qr-image" src="" alt="QR Code" style="display:none;">
        <p id="qr-code-text" style="display:none;"></p>
        <button id="download-btn" onclick="downloadQRCode()">Download QR Code</button>
    </div>
    <p style="font-size: 0.9em; color: #666; margin-top: 30px;">
        This tool runs entirely in your browser. No data is stored or sent anywhere.<br>
        No tracking, no ads, no nonsense.
        <br>
        <a href="https://github.com/timoheimonen/qrturbo" target="_blank" style="color: #007acc;">View source on GitHub</a>
    </p>
    <script src="js/qrcode.js"></script>
    <script>
        function openTab(evt, tabName) {
            let i, tabcontent, tablinks;
            tabcontent = document.getElementsByClassName("tab-content");
            for (i = 0; i < tabcontent.length; i++) {
                tabcontent[i].style.display = "none";
            }
            tablinks = document.getElementsByClassName("tab-link");
            for (i = 0; i < tablinks.length; i++) {
                tablinks[i].className = tablinks[i].className.replace(" active", "");
            }
            document.getElementById(tabName).style.display = "block";
            evt.currentTarget.className += " active";

            // Clear all input fields
            const inputs = document.querySelectorAll('input[type="text"], input[type="tel"], input[type="email"], input[type="url"]');
            inputs.forEach(input => input.value = '');

            // Reset character count
            const charCountDisplay = document.getElementById('char-count');
            charCountDisplay.textContent = '0 / 300 characters';
            charCountDisplay.classList.remove('warning');

            // Reset QR code display area
            const qrContainer = document.getElementById('qr-container');
            const qrImage = document.getElementById('qr-image');
            const downloadBtn = document.getElementById('download-btn');
            const qrCodeText = document.getElementById('qr-code-text');
            const qrPlaceholder = document.getElementById('qr-placeholder');
            
            qrPlaceholder.style.display = 'block';
            qrImage.src = "";
            qrImage.style.display = 'none';
            downloadBtn.style.display = 'none';
            qrCodeText.style.display = 'none';
            qrContainer.classList.remove('loading');

            // Reset container animation to initial state
            qrContainer.style.animation = 'none';
            qrContainer.offsetHeight; // Trigger reflow
            qrContainer.style.animation = 'slideInUp 0.8s ease-out 0.3s both';
        }

        function generateQRCode() {
            let text;
            const activeTabButton = document.querySelector('.tab-link.active');
            const activeTab = activeTabButton.getAttribute('onclick').includes('URLText') ? 'URLText' : 'VCard';

            if (activeTab === 'URLText') {
                text = document.getElementById('qr-text').value;
                if (!text) {
                    alert('Please enter some text or a URL');
                    return;
                }
            } else { // VCard
                const vcard = {
                    fn: document.getElementById('vcard-fn').value.trim(),
                    ln: document.getElementById('vcard-ln').value.trim(),
                    org: document.getElementById('vcard-org').value.trim(),
                    title: document.getElementById('vcard-title').value.trim(),
                    telWork: document.getElementById('vcard-tel-work').value.trim(),
                    telMobile: document.getElementById('vcard-tel-mobile').value.trim(),
                    email: document.getElementById('vcard-email').value.trim(),
                    url: document.getElementById('vcard-url').value.trim(),
                    street: document.getElementById('vcard-street').value.trim(),
                    city: document.getElementById('vcard-city').value.trim(),
                    state: document.getElementById('vcard-state').value.trim(),
                    zip: document.getElementById('vcard-zip').value.trim(),
                    country: document.getElementById('vcard-country').value.trim(),
                };

                if (!vcard.fn && !vcard.ln && !vcard.email && !vcard.telMobile && !vcard.telWork) {
                    alert('Please fill at least one of: First Name, Last Name, Email or Phone.');
                    return;
                }

                let vCardString = "BEGIN:VCARD\nVERSION:3.0\n";
                if (vcard.fn || vcard.ln) vCardString += `N:${vcard.ln};${vcard.fn}\n`;
                if (vcard.fn || vcard.ln) vCardString += `FN:${vcard.fn} ${vcard.ln}\n`;
                if (vcard.org) vCardString += `ORG:${vcard.org}\n`;
                if (vcard.title) vCardString += `TITLE:${vcard.title}\n`;
                if (vcard.telWork) vCardString += `TEL;TYPE=WORK,VOICE:${vcard.telWork}\n`;
                if (vcard.telMobile) vCardString += `TEL;TYPE=CELL,VOICE:${vcard.telMobile}\n`;
                if (vcard.email) vCardString += `EMAIL:${vcard.email}\n`;
                if (vcard.url) vCardString += `URL:${vcard.url}\n`;
                if (vcard.street || vcard.city || vcard.state || vcard.zip || vcard.country) {
                    vCardString += `ADR;TYPE=HOME:;;${vcard.street};${vcard.city};${vcard.state};${vcard.zip};${vcard.country}\n`;
                }
                vCardString += "END:VCARD";
                text = vCardString;
            }
            
            if (!text) {
                // This case should be handled above, but as a fallback.
                alert('No data provided for QR code.');
                return;
            }

            // Add loading animation
            const qrContainer = document.getElementById('qr-container');
            const qrImage = document.getElementById('qr-image');
            const downloadBtn = document.getElementById('download-btn');
            const qrCodeText = document.getElementById('qr-code-text');
            const qrPlaceholder = document.getElementById('qr-placeholder');
            
            qrContainer.classList.add('loading');
            qrPlaceholder.style.display = 'none';
            qrImage.style.opacity = '0.3';
            downloadBtn.style.display = 'none';
            qrCodeText.style.display = 'none';

            // Simulate a small delay for better UX
            setTimeout(() => {
                // Get selected size
                const sizeSelect = document.getElementById('size-select');
                const selectedSize = parseInt(sizeSelect.value);

                // Create QR code
                const qr = qrcode(0, 'M');
                qr.addData(text);
                qr.make();

                // Display QR code with animation
                qrImage.src = qr.createDataURL(selectedSize);
                qrImage.style.display = 'block';
                qrImage.style.opacity = '1';
                
                // Display the text content
                qrCodeText.textContent = text;
                qrCodeText.style.display = 'block';

                // Remove loading state
                qrContainer.classList.remove('loading');

                // Show download button with animation
                downloadBtn.style.display = 'block';
                
                // Add success animation to container
                qrContainer.style.animation = 'none';
                qrContainer.offsetHeight; // Trigger reflow
                qrContainer.style.animation = 'qrAppear 0.6s ease-out';
            }, 300);
        }

        function downloadQRCode() {
            const qrImage = document.getElementById('qr-image');
            const activeTabButton = document.querySelector('.tab-link.active');
            const activeTab = activeTabButton.getAttribute('onclick').includes('URLText') ? 'URLText' : 'VCard';

            let text;
             if (activeTab === 'URLText') {
                text = document.getElementById('qr-text').value;
            } else {
                const firstName = document.getElementById('vcard-fn').value;
                const lastName = document.getElementById('vcard-ln').value;
                text = `vcard_${firstName}_${lastName}`;
            }

            const safeText = text.replace(/[^a-z0-9]/gi, '_').substring(0, 50) || 'qr';

            const link = document.createElement('a');
            link.download = `qrcode_${safeText}.png`;
            link.href = qrImage.src;
            link.click();
            
            // Add download feedback animation
            const downloadBtn = document.getElementById('download-btn');
            downloadBtn.style.animation = 'none';
            downloadBtn.offsetHeight; // Trigger reflow
            downloadBtn.style.animation = 'bounceIn 0.6s ease-out';
        }

        // Add character count tracking with warning animation
        const qrTextInput = document.getElementById('qr-text');
        const charCountDisplay = document.getElementById('char-count');

        qrTextInput.addEventListener('input', function() {
            const currentLength = this.value.length;
            charCountDisplay.textContent = `${currentLength} / 300 characters`;
            
            // Add warning animation when approaching limit
            if (currentLength >= 250) {
                charCountDisplay.classList.add('warning');
            } else {
                charCountDisplay.classList.remove('warning');
            }
        });

        // Add enter key support
        qrTextInput.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                generateQRCode();
            }
        });

        // Add focus animations
        qrTextInput.addEventListener('focus', function() {
            this.style.transform = 'scale(1.02)';
        });

        qrTextInput.addEventListener('blur', function() {
            this.style.transform = 'scale(1)';
        });

        // Initialize page with smooth animations
        document.addEventListener('DOMContentLoaded', function() {
            // Add staggered animation delays for elements
            const elements = document.querySelectorAll('input, button, #size-select, #char-count, .tab-link');
            elements.forEach((element, index) => {
                element.style.animationDelay = `${0.5 + (index * 0.1)}s`;
            });
        });
    </script>
</body>
</html>